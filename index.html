<!DOCTYPE html>
<html>

<head>
    <title>Simple Map</title>
    <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
    <meta name="viewport" content="initial-scale=1.0" , user-scalable=no>
    <meta charset="utf-8">
    <link rel="stylesheet" type="text/css" href="css/main.css">
    <script type="text/javascript" src="http://webapi.amap.com/maps?v=1.3&key=19cacba68756210399cfed0012e65e05&plugin=AMap.Autocomplete"></script>
</head>

<body>
    <!-- <button onclick="doLocation()"> test</button> -->
    <input id="pac-input" class="controls" type="text" placeholder="">
    <div id="map"></div>
    <script src="js/main.js"></script>
    <script type="text/javascript">
    var html_language;
    var html_country;
    var array = location.search.split(/[\?\&=]/);
    for (var i = 1; i < array.length; i += 2) {
        if ('lan' === array[i]) {
            html_language = array[i + 1];
        }
        if ('country' === array[i]) {
            html_country = array[i + 1];
        }
    }

    if (html_language == null) {
        html_language = "zh";
    }

    if (html_country == null) {
        html_country = "CN";
    }
    var url
    if (html_country === "CN") {
        if (html_language === "zh") {
            //url = "<script src= 'js/google_map_api_zh.js' async defer><\/script>";
            url = "http://maps.google.cn/maps/api/js?key=AIzaSyD8ySZo45hAL7ZWNn5re_-5WXf7IRq5FwE&region=cn" + "&language=" + html_language + "&libraries=places,geometry";
        } else {
            //url = "<script src= 'js/google_map_api_en.js' async defer><\/script>";
            url = "http://maps.google.cn/maps/api/js?key=AIzaSyD8ySZo45hAL7ZWNn5re_-5WXf7IRq5FwE&region=cn" + "&language=" + html_language + "&libraries=places,geometry";
        }
    } else {
        url = "https://maps.google.com/maps/api/js?key=AIzaSyD8ySZo45hAL7ZWNn5re_-5WXf7IRq5FwE&country=" + html_country + "&language=" + html_language + "&libraries=places,geometry";
    }

    var script = document.createElement('script');
    script.onload = script.onreadystatechange = function() {
        initMap();
        script.onload = script.onreadystatechange = null;
    }
    script.setAttribute('src', url);
    document.getElementsByTagName('head')[0].appendChild(script);
    </script>
</body>

</html>
